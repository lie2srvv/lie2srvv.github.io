<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>lie2srvv</title>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;700&display=swap" rel="stylesheet">
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
<script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
<style>
html,body{margin:0;padding:0;width:100%;height:100%;font-family:'Montserrat',sans-serif;background:#0a0a0a;color:#e0e0e0;overflow:hidden;}
#root{width:100%;height:100%;position:relative;z-index:10;}
#snow-canvas{position:fixed;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:1;}
canvas#drawing-canvas{position:absolute;top:0;left:0;z-index:5;}
.card{background:#141414;border-radius:2.5rem;border:1px solid rgba(255,255,255,0.07);padding:2rem;max-width:360px;margin:auto;}
.color-dot{width:30px;height:30px;border-radius:50%;border:1px solid rgba(255,255,255,0.1);transition:0.2s;}
.color-dot.active{transform:scale(1.3);border-color:#fff;box-shadow:0 0 15px rgba(255,255,255,0.3);}
.rgb-btn{background:linear-gradient(45deg,#ff0000,#ff7300,#fffb00,#48ff00,#00ffd5,#002bff,#7a00ff,#ff00c8,#ff0000);background-size:400%;animation:moveGradient 5s linear infinite;border:none;color:white;font-weight:bold;text-shadow:0 1px 2px rgba(0,0,0,0.5);}
@keyframes moveGradient{0%{background-position:0% 50%;}50%{background-position:100% 50%;}100%{background-position:0% 50%;}}
.custom-color-input{width:60px;height:30px;padding:0 5px;border:none;border-radius:0.5rem;cursor:pointer;background:#222;color:#fff;text-transform:uppercase;}
.nav-link{width:80%;max-width:300px;padding:20px;background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.05);border-radius:1.5rem;text-align:center;transition:all 0.3s ease;}
</style>
</head>
<body>
<canvas id="snow-canvas"></canvas>
<canvas id="drawing-canvas"></canvas>
<div id="root"></div>

<script type="text/babel">
const {useState,useEffect,useRef}=React;

// Снег
const startSnow=()=>{
  const canvas=document.getElementById('snow-canvas');
  const ctx=canvas.getContext('2d');
  let w,h,particles=[];
  const resize=()=>{w=canvas.width=window.innerWidth;h=canvas.height=window.innerHeight;}
  class Particle{constructor(){this.init();}
    init(){this.x=Math.random()*w;this.y=Math.random()*-h;this.size=Math.random()*3+2;this.speed=Math.random()*0.5+0.3;this.opacity=Math.random()*0.4+0.2;this.offset=Math.random()*2000;}
    update(){this.y+=this.speed;this.x+=Math.sin((Date.now()+this.offset)*0.0015)*0.5;if(this.y>h)this.init();}
    draw(){ctx.beginPath();const g=ctx.createRadialGradient(this.x,this.y,0,this.x,this.y,this.size);g.addColorStop(0,`rgba(255,255,255,${this.opacity})`);g.addColorStop(1,'transparent');ctx.fillStyle=g;ctx.arc(this.x,this.y,this.size,0,Math.PI*2);ctx.fill();}
  }
  window.addEventListener('resize',resize); resize();
  for(let i=0;i<70;i++)particles.push(new Particle());
  const animate=()=>{ctx.clearRect(0,0,w,h);particles.forEach(p=>{p.update();p.draw();});requestAnimationFrame(animate);}
  animate();
}

const App=()=>{
  const [currentPage,setCurrentPage]=useState('info');
  const [menuOpen,setMenuOpen]=useState(false);
  const [paths,setPaths]=useState([]);
  const [currentColor,setCurrentColor]=useState('#FFFFFF');
  const [isRGB,setIsRGB]=useState(false);
  const [hue,setHue]=useState(0);
  const [brushWidth,setBrushWidth]=useState(4);

  const canvasRef=useRef(null);
  const currentPathRef=useRef(null);

  const colors=["#FFFFFF","#FF0000","#FF7F00","#FFFF00","#00FF00","#0000FF","#4B0082","#8B00FF"];
  const chars="АБВГДЕЁЖЗИЙКЛМНОПРСТУФХЦЧШЩЪЫЬЭЮЯ";

  useEffect(()=>{startSnow();},[]);

  useEffect(()=>{
    const drawCanvas=document.getElementById('drawing-canvas');
    const resizeCanvas=()=>{drawCanvas.width=window.innerWidth;drawCanvas.height=window.innerHeight;}
    window.addEventListener('resize',resizeCanvas);
    resizeCanvas();
  },[]);

  useEffect(()=>{
    const interval=setInterval(()=>{setHue(h=> (h+1)%360);},30);
    return ()=>clearInterval(interval);
  },[]);

  useEffect(()=>{
    const draw=()=>{
      const ctx=canvasRef.current?.getContext('2d');
      if(!ctx) return;
      ctx.clearRect(0,0,ctx.canvas.width,ctx.canvas.height);
      paths.forEach(p=>{
        ctx.beginPath();
        ctx.lineWidth=p.w; ctx.lineCap='round'; ctx.lineJoin='round'; ctx.strokeStyle=p.c;
        ctx.moveTo(p.pts[0].x,p.pts[0].y);
        p.pts.forEach(pt=>ctx.lineTo(pt.x,pt.y));
        ctx.stroke();
      });
      if(currentPathRef.current){
        ctx.beginPath();
        ctx.lineWidth=currentPathRef.current.w; ctx.lineCap='round'; ctx.lineJoin='round';
        ctx.strokeStyle=currentPathRef.current.c;
        ctx.moveTo(currentPathRef.current.pts[0].x,currentPathRef.current.pts[0].y);
        currentPathRef.current.pts.forEach(pt=>ctx.lineTo(pt.x,pt.y));
        ctx.stroke();
      }
      requestAnimationFrame(draw);
    }
    draw();
  },[paths]);

  const getPos=(e)=>{
    const r=canvasRef.current.getBoundingClientRect();
    const clientX=e.touches?e.touches[0].clientX:e.clientX;
    const clientY=e.touches?e.touches[0].clientY:e.clientY;
    return {x:clientX-r.left,y:clientY-r.top};
  }

  const startDrawing=(e)=>{
    const col=isRGB?`hsl(${hue},100%,65%)`:currentColor;
    currentPathRef.current={c:col,pts:[getPos(e)],w:brushWidth};
  }
  const moveDrawing=(e)=>{if(currentPathRef.current){e.preventDefault();currentPathRef.current.pts.push(getPos(e));}}
  const endDrawing=()=>{if(currentPathRef.current){setPaths(prev=>[...prev,currentPathRef.current]);currentPathRef.current=null;}}

  return (
    <div className="w-full h-full flex items-center justify-center p-4" style={{position:'relative',zIndex:10}}>
      <button onClick={()=>setMenuOpen(!menuOpen)} className="fixed top-8 right-8 z-[110] p-4 bg-[#1a1a1a] border border-white/10 rounded-2xl">
        <div className="w-6 h-4 flex flex-col justify-between items-end">
          <span className={`h-0.5 bg-white transition-all ${menuOpen?'w-6 rotate-45 translate-y-2':'w-6'}`}/>
          <span className={`h-0.5 bg-white transition-all ${menuOpen?'opacity-0':'w-4'}`}/>
          <span className={`h-0.5 bg-white transition-all ${menuOpen?'w-6 -rotate-45 -translate-y-1.5':'w-5'}`}/>
        </div>
      </button>

      <nav className={`fixed inset-0 z-[100] bg-[#0a0a0ae0] backdrop-blur-2xl transition-all duration-500 flex flex-col items-center justify-center gap-6 ${menuOpen?'translate-x-0 opacity-100':'translate-x-full opacity-0'}`}>
        <button onClick={()=>{setCurrentPage('info'); setMenuOpen(false);}} className="nav-link">Профиль</button>
        <button onClick={()=>{setCurrentPage('draw'); setMenuOpen(false);}} className="nav-link">Холст</button>
      </nav>

      {currentPage==='draw' && (
        <div className="absolute inset-0 z-20">
          <canvas ref={canvasRef} id="drawing-canvas"
            onMouseDown={startDrawing} onMouseMove={moveDrawing} onMouseUp={endDrawing} onMouseLeave={endDrawing}
            onTouchStart={startDrawing} onTouchMove={moveDrawing} onTouchEnd={endDrawing}
          />
          <div className="fixed bottom-10 left-1/2 -translate-x-1/2 flex flex-col items-center gap-3 bg-[#141414]/95 backdrop-blur-2xl p-6 rounded-[3rem] border border-white/10 shadow-2xl w-[90%] max-w-fit">
            <div className="flex gap-2 items-center flex-wrap justify-center">
              {colors.map((c,i)=>(
                <button key={i} onClick={()=>{setCurrentColor(c); setIsRGB(false);}} className={`color-dot ${currentColor===c&&!isRGB?'active':''}`} style={{background:c}}/>
              ))}
              <input type="text" value={currentColor} maxLength={7} onChange={(e)=>setCurrentColor(e.target.value)} className="custom-color-input" placeholder="#FFFFFF"/>
              <button onClick={()=>setIsRGB(!isRGB)} className={`rgb-btn px-4 py-1.5 rounded-full text-[10px] uppercase tracking-tighter shadow-inner transition-all ${isRGB?'ring-2 ring-white scale-110':'opacity-80'}`}>RGB</button>
            </div>
            <div className="flex gap-3 items-center mt-2">
              <label className="text-[10px] text-[#888]">Ширина:</label>
              <input type="range" min="1" max="20" value={brushWidth} onChange={e=>setBrushWidth(e.target.value)} className="w-40"/>
              <button onClick={()=>setPaths([])} className="text-[10px] px-3 py-1 bg-white/10 rounded-xl">Очистить</button>
            </div>
          </div>
        </div>
      )}
    </div>
  );
}

ReactDOM.createRoot(document.getElementById('root')).render(<App/>);
</script>
</body>
</html>
